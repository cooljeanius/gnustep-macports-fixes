# $Id: Portfile 86447 2011-10-26 00:14:09Z ryandesign@macports.org $

PortSystem 1.0

name            gnustep-make
version         2.6.1
categories      gnustep devel cross
platforms       darwin
license         GPL-3+
maintainers     nomaintainer
supported_archs noarch
installs_libs   no

homepage        http://www.gnustep.org/
description     GNUstep makefile package
long_description \
    The GNUstep makefile package is a simple, powerful and extensible way to \
    write makefiles for a GNUstep-based project.  It allows the user to \
    write a project without having to deal with the complex issues \
    associated with configuration, building, installation, and packaging. \
    It also allows the user to easily create cross-compiled binaries.

master_sites        gnustep:core

checksums           rmd160  a72970e1bf0fa93622981e991717714795cdb7a5 \
                    sha256  c48b0a4c85eee4799b12cceeb327c470b168100cbcda4f111b1edad71f8762eb

configure.compiler  macports-gcc-4.6
depends_build-append port:gcc46

# defaults to: --prefix=${prefix}
configure.pre_args  --prefix=${prefix}/GNUstep

# we can not use the fhs layout, because that uses /opt/local/lib as the GNUstep system library
# directory, and gnustep-make adds the system library directory to DYLD_LIBRARY_PATH when 
# GNUstep.sh is sourced. 
# having /opt/local/lib in DYLD_LIBRARY_PATH can mess up macports. e.g. pkg-config 
# will stop working because it loads the macports libjpeg when it should load the system
# libjpeg.
configure.args      --with-library-combo=gnu-gnu-gnu \
                    --with-objc-lib-flag=-lobjc-gnu \
                    --with-layout=gnustep \
                    --with-config-file=${prefix}/GNUstep/GNUstep.conf

destroot.args       messages=yes

# we install into ${prefix}/GNUstep which is a violation of the macports filesystem standard
destroot.violate_mtree  yes

notes               "\
##########################################################
To have a fully working GNUstep make system, please add
'. ${prefix}/GNUstep/System/Library/Makefiles/GNUstep.sh'
to your shell login (in ~/.profile)
##########################################################
"
